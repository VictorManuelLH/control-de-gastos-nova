rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Reglas para las notas del usuario
    // Ruta: {userId}/journal/notes/{noteId}
    match /{userId}/journal/notes/{noteId} {
      // Permitir lectura y escritura solo si el usuario está autenticado
      // y el userId coincide con el uid del usuario autenticado
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }

    // Reglas para las transacciones del usuario (gastos e ingresos)
    // Ruta: {userId}/expenses/transactions/{transactionId}
    match /{userId}/expenses/transactions/{transactionId} {
      // Permitir lectura y escritura solo si el usuario está autenticado
      // y el userId coincide con el uid del usuario autenticado
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }

    // Reglas para los presupuestos del usuario
    // Ruta: {userId}/expenses/budgets/{budgetId}
    match /{userId}/expenses/budgets/{budgetId} {
      // Permitir lectura y escritura solo si el usuario está autenticado
      // y el userId coincide con el uid del usuario autenticado
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }

    // Regla por defecto: denegar todo el resto
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
